// @bun
var L=32;var K=async(t)=>{let r=t.clone(),R=`HTTP ${t.status} ${t.statusText} for ${t.url}`,j=await t.json().catch(()=>null);if(j&&typeof j==="object"&&Object.keys(j).length)return new Error(`${R}
${JSON.stringify(j)}`);let _=await r.text().catch(()=>"");if(_)return new Error(`${R}
${_}`);return new Error(R)},Q=(t)=>{let r;if(typeof t==="string")r=t;else r=(t instanceof Uint8Array?t:new Uint8Array(t)).reduce((j,_)=>j+String.fromCharCode(_),"");return btoa(r)},z=({url:t,body:r,authIn:R,headers:j,encoding:_,clientId:W,clientSecret:F})=>{let x=new Headers(j);if(x.set("Accept","application/json"),x.set("User-Agent","citra"),R==="header"){if(!F)throw new Error("clientSecret required for header auth");x.set("Authorization",`Basic ${Q(`${W}:${F}`)}`)}if(_==="json")return x.set("Content-Type","application/json"),new Request(t,{body:JSON.stringify(r),headers:x,method:"POST"});x.set("Content-Type","application/x-www-form-urlencoded");let C=r instanceof URLSearchParams?Array.from(r.entries()):Object.entries(r).filter((s)=>typeof s[1]==="string"),O=new URLSearchParams(C);if(R==="body")O.set("client_id",W),F&&O.set("client_secret",F);return new Request(t,{body:O.toString(),headers:x,method:"POST"})};var D=async(t)=>{let r=new TextEncoder().encode(t),R=await crypto.subtle.digest("SHA-256",r);return S(R)},N=(t)=>()=>{let r=crypto.getRandomValues(new Uint8Array(t));return S(r)},v=N(L),B=N(L),S=(t)=>Q(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");var q=(t)=>t,M=q({"42":{authorizationUrl:"https://api.intra.42.fr/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.intra.42.fr/v2/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.intra.42.fr/oauth/token"}},AmazonCognito:{authorizationUrl:"https://${domain}/oauth2/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`https://${t.domain}/oauth2/userInfo`},revocationRequest:{authIn:"body",tokenParamName:"token",url:(t)=>`https://${t.domain}/oauth2/revoke`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`https://${t.domain}/oauth2/token`}},AniList:{authorizationUrl:"https://anilist.co/api/v2/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",body:{query:"query { Viewer { id name } }"},headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",url:"https://graphql.anilist.co"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://anilist.co/api/v2/oauth/token"}},Apple:{authorizationUrl:"https://appleid.apple.com/auth/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://appleid.apple.com/auth/userinfo"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://appleid.apple.com/auth/token"}},Atlassian:{authorizationUrl:"https://auth.atlassian.com/authorize",createAuthorizationURLSearchParams:{audience:"api.atlassian.com"},isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.atlassian.com/me"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://auth.atlassian.com/oauth/token"}},Auth0:{authorizationUrl:(t)=>`https://${t.domain}/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`https://${t.domain}/userinfo`},revocationRequest:{authIn:"body",body:new URLSearchParams({token_type_hint:"refresh_token"}),tokenParamName:"token",url:(t)=>`https://${t.domain}/oauth/revoke`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`https://${t.domain}/oauth/token`}},Authentik:{authorizationUrl:(t)=>`https://${t.baseURL}/oauth/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`https://${t.baseURL}/api/v3/user/`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`https://${t.baseURL}/oauth/token`}},Autodesk:{authorizationUrl:"https://developer.api.autodesk.com/authentication/v2/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.userprofile.autodesk.com/userinfo"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://developer.api.autodesk.com/authentication/v2/token"}},Battlenet:{authorizationUrl:"https://oauth.battle.net/authorize",isOIDC:!0,isRefreshable:!1,profileRequest:{authIn:"header",method:"GET",url:"https://oauth.battle.net/userinfo"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://oauth.battle.net/token"}},Bitbucket:{authorizationUrl:"https://bitbucket.org/site/oauth2/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.bitbucket.org/2.0/user"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://bitbucket.org/site/oauth2/access_token"}},Box:{authorizationUrl:"https://account.box.com/api/oauth2/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.box.com/2.0/users/me"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://api.box.com/oauth2/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.box.com/oauth2/token"}},Bungie:{authorizationUrl:"https://www.bungie.net/en/OAuth/Authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",headers:{"X-API-Key":"<YOUR_API_KEY>"},method:"GET",url:"https://www.bungie.net/Platform/User/GetCurrentBungieNetUser"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://www.bungie.net/Platform/App/OAuth/token"}},Coinbase:{authorizationUrl:"https://www.coinbase.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.coinbase.com/v2/user"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.coinbase.com/oauth/token"}},Discord:{authorizationUrl:"https://discord.com/api/oauth2/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://discord.com/api/users/@me"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://discord.com/api/oauth2/token"}},DonationAlerts:{authorizationUrl:"https://www.donationalerts.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://www.donationalerts.com/api/v1/user/oauth"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://www.donationalerts.com/oauth/token"}},Dribbble:{authorizationUrl:"https://dribbble.com/oauth/authorize",isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"header",method:"GET",url:"https://api.dribbble.com/v2/user"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://dribbble.com/oauth/token"}},Dropbox:{authorizationUrl:"https://www.dropbox.com/oauth2/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"POST",url:"https://api.dropboxapi.com/2/users/get_current_account"},revocationRequest:{authIn:"header",url:"https://api.dropboxapi.com/2/auth/token/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.dropboxapi.com/oauth2/token"}},EpicGames:{authorizationUrl:"https://www.epicgames.com/id/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.epicgames.dev/epic/oauth/v2/userInfo"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.epicgames.dev/epic/oauth/v1/token"}},Etsy:{authorizationUrl:"https://www.etsy.com/oauth/connect",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://openapi.etsy.com/v3/application/users/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.etsy.com/v3/public/oauth/token"}},Facebook:{authorizationUrl:"https://www.facebook.com/v16.0/dialog/oauth",isOIDC:!0,isRefreshable:!1,PKCEMethod:"S256",profileRequest:{authIn:"query",method:"GET",searchParams:[["fields","id,name,email,picture"]],url:"https://graph.facebook.com/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://graph.facebook.com/v16.0/oauth/access_token"}},Figma:{authorizationUrl:"https://www.figma.com/oauth",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.figma.com/v1/me"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.figma.com/v1/oauth/token"}},Gitea:{authorizationUrl:(t)=>`${t.baseURL}/login/oauth/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`${t.baseURL}/api/v1/user`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`${t.baseURL}/login/oauth/access_token`}},GitHub:{authorizationUrl:"https://github.com/login/oauth/authorize",isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"header",method:"GET",url:"https://api.github.com/user"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://github.com/login/oauth/access_token"}},GitLab:{authorizationUrl:(t)=>`${t.baseURL}/oauth/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://gitlab.com/api/v4/user"},revocationRequest:{authIn:"body",tokenParamName:"token",url:(t)=>`${t.baseURL}/oauth/revoke`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`${t.baseURL}/oauth/token`}},Google:{authorizationUrl:"https://accounts.google.com/o/oauth2/v2/auth",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",searchParams:[["personFields","names,emailAddresses,photos"]],url:"https://people.googleapis.com/v1/people/me"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://oauth2.googleapis.com/revoke"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://oauth2.googleapis.com/token"}},Intuit:{authorizationUrl:"https://appcenter.intuit.com/connect/oauth2",isOIDC:!0,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:(t)=>t.environment==="production"?"https://accounts.platform.intuit.com/v1/openid_connect/userinfo":"https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo"},revocationRequest:{authIn:"body",headers:(t)=>({Authorization:`Basic ${Q(`${t.clientId}:${t.clientSecret}`)}`}),tokenParamName:"token",url:"https://developer.api.intuit.com/v2/oauth2/tokens/revoke"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer"}},Kakao:{authorizationUrl:"https://kauth.kakao.com/oauth/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://kapi.kakao.com/v2/user/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://kauth.kakao.com/oauth/token"}},Keycloak:{authorizationUrl:(t)=>`${t.realmURL}/protocol/openid-connect/auth`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.kick.com/v1/user"},revocationRequest:{authIn:"body",tokenParamName:"token",url:(t)=>`${t.realmURL}/protocol/openid-connect/revoke`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`${t.realmURL}/protocol/openid-connect/token`}},Kick:{authorizationUrl:"https://id.kick.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://id.kick.com/v1/user"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://id.kick.com/oauth/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://id.kick.com/oauth/token"}},Lichess:{authorizationUrl:"https://lichess.org/oauth/authorize",isOIDC:!1,isRefreshable:!1,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://lichess.org/api/account"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://lichess.org/api/token"}},LINE:{authorizationUrl:"https://access.line.me/oauth2/v2.1/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.line.me/v2/profile"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.line.me/oauth2/v2.1/token"}},Linear:{authorizationUrl:"https://linear.app/oauth/authorize",isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"header",body:{query:"query { viewer { id name } }"},headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",url:"https://api.linear.app/graphql"},revocationRequest:{authIn:"header",url:"https://api.linear.app/oauth/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.linear.app/oauth/token"}},LinkedIn:{authorizationUrl:"https://www.linkedin.com/oauth/v2/authorization",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.linkedin.com/v2/me"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://www.linkedin.com/oauth/v2/accessToken"}},Mastodon:{authorizationUrl:(t)=>`${t.baseURL}/oauth/authorize`,isOIDC:!1,isRefreshable:!1,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`${t.baseURL}/api/v1/accounts/verify_credentials`},revocationRequest:{authIn:"body",tokenParamName:"token",url:(t)=>`${t.baseURL}/oauth/revoke`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`${t.baseURL}/oauth/token`}},MercadoLibre:{authorizationUrl:"https://auth.mercadolibre.com/authorization",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.mercadolibre.com/users/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.mercadolibre.com/oauth/token"}},MercadoPago:{authorizationUrl:"https://auth.mercadopago.com/authorization",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.mercadopago.com/v1/users/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.mercadopago.com/oauth/token"}},MicrosoftEntraId:{authorizationUrl:(t)=>`https://${t.tenantId}.b2clogin.com/${t.tenantId}/oauth2/v2.0/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`https://${t.tenantId}.b2clogin.com/${t.tenantId}/openid/userinfo`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`https://${t.tenantId}.b2clogin.com/${t.tenantId}/oauth2/v2.0/token`}},MyAnimeList:{authorizationUrl:"https://myanimelist.net/v1/oauth2/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"plain",profileRequest:{authIn:"header",method:"GET",url:"https://api.myanimelist.net/v2/users/@me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://myanimelist.net/v1/oauth2/token"}},Naver:{authorizationUrl:"https://nid.naver.com/oauth2.0/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://openapi.naver.com/v1/nid/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://nid.naver.com/oauth2.0/token"}},Notion:{authorizationUrl:"https://api.notion.com/v1/oauth/authorize",isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"header",headers:{"Notion-Version":"2022-06-28"},method:"GET",url:"https://api.notion.com/v1/users/me"},scopeRequired:!1,tokenRequest:{authIn:"header",encoding:"json",url:"https://api.notion.com/v1/oauth/token"}},Okta:{authorizationUrl:(t)=>`https://${t.domain}/oauth2/default/v1/authorize`,isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:(t)=>`https://${t.domain}/oauth2/default/v1/userinfo`},revocationRequest:{authIn:"body",tokenParamName:"token",url:(t)=>`https://${t.domain}/oauth2/default/v1/revoke`},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`https://${t.domain}/oauth2/default/v1/token`}},Osu:{authorizationUrl:"https://osu.ppy.sh/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://osu.ppy.sh/api/v2/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://osu.ppy.sh/oauth/token"}},Patreon:{authorizationUrl:"https://www.patreon.com/oauth2/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://www.patreon.com/api/oauth2/v2/identity"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://www.patreon.com/api/oauth2/token"}},Polar:{authorizationUrl:"https://polar.sh/oauth2/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.polar.sh/v1/oauth2/userinfo"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://api.polar.sh/v1/oauth2/revoke"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.polar.sh/v1/oauth2/token"}},PolarAccessLink:{authorizationUrl:"https://flow.polar.com/oauth2/authorization",isOIDC:!1,isRefreshable:!1,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://www.polaraccesslink.com/v3/users/me"},scopeRequired:!1,tokenRequest:{authIn:"header",encoding:"form",url:"https://polarremote.com/v2/oauth2/token"}},PolarTeamPro:{authorizationUrl:"https://auth.polar.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://www.polaraccesslink.com/v3/users/<USER_ID>"},scopeRequired:!1,tokenRequest:{authIn:"header",encoding:"form",url:"https://auth.polar.com/oauth/token"}},Reddit:{authorizationUrl:"https://www.reddit.com/api/v1/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://oauth.reddit.com/api/v1/me"},revocationRequest:{authIn:"header",body:new URLSearchParams({token_type_hint:"refresh_token"}),url:"https://www.reddit.com/api/v1/revoke_token"},scopeRequired:!0,tokenRequest:{authIn:"header",encoding:"form",url:"https://www.reddit.com/api/v1/access_token"}},Roblox:{authorizationUrl:"https://apis.roblox.com/oauth/v1/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://apis.roblox.com/oauth/v1/userinfo"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://apis.roblox.com/oauth/v1/token"}},Salesforce:{authorizationUrl:"https://login.salesforce.com/services/oauth2/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://login.salesforce.com/services/oauth2/userinfo"},revocationRequest:{authIn:"header",url:"https://login.salesforce.com/services/oauth2/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://login.salesforce.com/services/oauth2/token"}},Shikimori:{authorizationUrl:"https://shikimori.org/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://shikimori.one/api/users/whoami"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://shikimori.org/oauth/token"}},Slack:{authorizationUrl:"https://slack.com/openid/connect/authorize",isOIDC:!0,isRefreshable:!0,profileRequest:{authIn:"query",method:"GET",url:"https://slack.com/api/users.identity"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://slack.com/api/auth.revoke"},scopeRequired:!0,tokenRequest:{authIn:"body",encoding:"form",url:"https://slack.com/api/openid.connect.token"}},Spotify:{authorizationUrl:"https://accounts.spotify.com/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.spotify.com/v1/me"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://accounts.spotify.com/api/token"}},StartGG:{authorizationUrl:"https://start.gg/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",body:{query:"query { currentUser { id slug email player { gamerTag } } }"},headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",url:"https://api.start.gg/gql/alpha"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.start.gg/oauth/access_token"}},Strava:{authorizationUrl:"https://www.strava.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://www.strava.com/api/v3/athlete"},revocationRequest:{authIn:"query",body:new URLSearchParams({token_type_hint:"access_token"}),tokenParamName:"access_token",url:"https://www.strava.com/oauth/deauthorize"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://www.strava.com/oauth/token"}},Synology:{authorizationUrl:(t)=>`${t.baseURL}/webman/sso/SSOOauth.cgi?client_id=${t.clientId}&response_type=code&redirect_uri=${t.redirectUri}`,isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"header",method:"GET",url:(t)=>`${t.baseURL}/webman/sso/SSOUserInfo.cgi?client_id=${t.clientId}&access_token=${t.accessToken}`},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:(t)=>`${t.baseURL}/webman/sso/SSOAccessToken.cgi?client_id=${t.clientId}&client_secret=${t.clientSecret}`}},TikTok:{authorizationUrl:"https://www.tiktok.com/v2/auth/authorize",createAuthorizationURLSearchParams:(t)=>({client_key:t.clientId}),isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"query",method:"GET",url:"https://open.douyin.com/oauth/userinfo"},revocationRequest:{authIn:"body",tokenParamName:"token",url:"https://open.tiktokapis.com/v2/oauth/revoke/"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://open.tiktokapis.com/v2/oauth/token/"}},Tiltify:{authorizationUrl:"https://v5api.tiltify.com/oauth/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://v5api.tiltify.com/api/public/current-user"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://v5api.tiltify.com/oauth/token"}},Tumblr:{authorizationUrl:"https://www.tumblr.com/oauth2/authorize",isOIDC:!1,isRefreshable:!0,profileRequest:{authIn:"header",method:"GET",url:"https://api.tumblr.com/v2/user/info"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.tumblr.com/v2/oauth2/token"}},Twitch:{authorizationUrl:"https://id.twitch.tv/oauth2/authorize",isOIDC:!0,isRefreshable:!0,profileRequest:{authIn:"header",headers:(t)=>({"Client-Id":t.clientId}),method:"GET",url:"https://api.twitch.tv/helix/users"},revocationRequest:{authIn:"query",headers:(t)=>({"Client-Id":t.clientId}),tokenParamName:"token",url:"https://id.twitch.tv/oauth2/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://id.twitch.tv/oauth2/token"}},Twitter:{authorizationUrl:"https://twitter.com/i/oauth2/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.twitter.com/2/users/me"},revocationRequest:{authIn:"header",url:"https://api.twitter.com/2/oauth2/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.twitter.com/2/oauth2/token"}},VK:{authorizationUrl:"https://oauth.vk.com/authorize",isOIDC:!1,isRefreshable:!1,profileRequest:{authIn:"query",method:"GET",url:"https://api.vk.com/method/users.get"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://oauth.vk.com/access_token"}},WorkOS:{authorizationUrl:"https://api.workos.com/sso/authorize",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.workos.com/sso/userinfo"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.workos.com/sso/token"}},Yahoo:{authorizationUrl:"https://api.login.yahoo.com/oauth2/request_auth",isOIDC:!0,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.login.yahoo.com/openid/v1/userinfo"},revocationRequest:{authIn:"header",url:"https://api.login.yahoo.com/oauth2/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://api.login.yahoo.com/oauth2/get_token"}},Yandex:{authorizationUrl:"https://oauth.yandex.com/authorize",createAuthorizationURLSearchParams:{device_id:crypto.randomUUID(),device_name:`${navigator.platform??"Unknown"} \u2014 ${(navigator.userAgent.split(")")[0]||"").split("(").pop()||"Unknown"}`},isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://login.yandex.ru/info"},revocationRequest:{authIn:"body",tokenParamName:"access_token",url:"https://oauth.yandex.com/revoke_token"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://oauth.yandex.com/token"}},Zoom:{authorizationUrl:"https://zoom.us/oauth/authorize",isOIDC:!1,isRefreshable:!0,PKCEMethod:"S256",profileRequest:{authIn:"header",method:"GET",url:"https://api.zoom.us/v2/users/me"},revocationRequest:{authIn:"query",headers:(t)=>({Authorization:`Basic ${btoa(`${t.clientId}:${t.clientSecret}`)}`}),tokenParamName:"token",url:"https://zoom.us/oauth/revoke"},scopeRequired:!1,tokenRequest:{authIn:"body",encoding:"form",url:"https://zoom.us/oauth/token"}}});var U=(t)=>{if(typeof t!=="object"||t===null)return!1;return typeof Reflect.get(t,"clientSecret")==="string"};var g=(t,r)=>{let R=M[t],j=(x)=>typeof x==="function",_=(x)=>j(x)?x(r):x,W=_(R.authorizationUrl),F=_(R.tokenRequest.url);return{async createAuthorizationUrl(x){let{state:C,scope:O=[],searchParams:s=[],codeVerifier:u}=x??{},A=new URL(W);if(A.searchParams.set("response_type","code"),A.searchParams.set("client_id",r.clientId),r.redirectUri)A.searchParams.set("redirect_uri",r.redirectUri);if(C)A.searchParams.set("state",C);if(O.length)A.searchParams.set("scope",O.join(" "));if(R.PKCEMethod!==void 0){if(u===void 0)throw new Error("`codeVerifier` is required when `meta.isPKCE` is true");let $=R.PKCEMethod==="S256"?await D(u):u;A.searchParams.set("code_challenge_method",R.PKCEMethod),A.searchParams.set("code_challenge",$)}let{createAuthorizationURLSearchParams:h}=R;return Object.entries(_(h)??{}).forEach(([$,P])=>A.searchParams.set($,P)),s.forEach(([$,P])=>A.searchParams.set($,P)),A},async fetchUserProfile(x){let{profileRequest:C}=R,{url:O,method:s,authIn:u,searchParams:A,body:h,headers:$}=C,P=new URL(_(O)),p=new URLSearchParams(A);for(let[Z,b]of p.entries())P.searchParams.append(Z,b);let w=$?_($):void 0,y=[];if(w instanceof Headers)y=Array.from(w.entries());if(Array.isArray(w))y=w;if(w&&typeof w==="object"&&!(w instanceof Headers)&&!Array.isArray(w))y=Object.entries(w);let J=y.filter(([,Z])=>Z!==""),T=Object.fromEntries(J);if(u==="header")T.Authorization=`Bearer ${x}`;else P.searchParams.append("access_token",x);let Y={headers:T,method:s};if(s==="POST"&&h)T["Content-Type"]="application/json",Y.body=JSON.stringify(h);let X=await fetch(P.toString(),Y);if(!X.ok)throw await K(X);return X.json()},async refreshAccessToken(x){let{authIn:C,encoding:O}=R.tokenRequest,s=new URLSearchParams(R.refreshAccessTokenBody);s.set("grant_type","refresh_token"),s.set("refresh_token",x);let{clientId:u}=r,A;if(U(r)){let{clientSecret:P}=r;A=P,s.set("client_id",u),s.set("client_secret",P)}let h=z({authIn:C,body:s,clientId:u,clientSecret:A,encoding:O,url:F}),$=await fetch(h);if(!$.ok)throw await K($);return $.json()},async revokeToken(x){let{revocationRequest:C}=R;if(!C)throw new Error("Token revocation request is not defined for this provider");let{url:O,authIn:s,body:u,headers:A,tokenParamName:h}=C,$=_(O),P=u??new URLSearchParams,p=new Headers(A&&_(A)),{clientId:w}=r,y=U(r)?r.clientSecret:void 0,J;if(s==="body")P.set(h,x),P.set("client_id",w),y&&P.set("client_secret",y),J=z({authIn:"body",body:P,clientId:w,clientSecret:y,encoding:"form",headers:p,url:$.toString()});else if(s==="header")p?.set("Authorization",`Bearer ${x}`),J=z({authIn:"header",body:P,clientId:w,clientSecret:y,encoding:"form",headers:p,url:$.toString()});else J=z({authIn:"query",body:P,clientId:w,clientSecret:y,encoding:"form",headers:p,url:`${$.toString()}?${h}=${x}`});let T=await fetch(J);if(!T.ok)throw await K(T)},async validateAuthorizationCode(x){let{code:C,codeVerifier:O}=x,{authIn:s,encoding:u}=R.tokenRequest,A={},h=R.validateAuthorizationCodeBody??{};for(let w in h){let y=h[w];if(typeof y!=="string")continue;A[w]=y}if(A.grant_type="authorization_code",A.code=C,r.redirectUri)A.redirect_uri=r.redirectUri;if(R.PKCEMethod!==void 0){if(!O)throw new Error("codeVerifier required when PKCE is enabled");A.code_verifier=O}let $=u==="json"?A:new URLSearchParams(A),P=z({authIn:s,body:$,clientId:r.clientId,clientSecret:"clientSecret"in r&&r.clientSecret?r.clientSecret:void 0,encoding:u,url:F}),p=await fetch(P);if(!p.ok)throw await K(p);return p.json()}}};export{g as createOAuth2Client};
